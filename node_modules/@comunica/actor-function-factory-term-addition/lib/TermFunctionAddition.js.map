{"version":3,"file":"TermFunctionAddition.js","sourceRoot":"","sources":["TermFunctionAddition.ts"],"names":[],"mappings":";;;AAAA,yEAAkE;AAMlE,qFAU8C;AAC9C,+CAAyC;AAEzC,MAAa,oBAAqB,SAAQ,uCAAgB;IACxD;QACE,KAAK,CAAC;YACJ,KAAK,EAAE,CAAC;YACR,QAAQ,EAAE,2CAAc,CAAC,QAAQ;YACjC,SAAS,EAAE,IAAA,oCAAO,EAAC,2CAAc,CAAC,QAAQ,CAAC;iBACxC,UAAU,CAAC,GAAG,EAAE,CAAC,CAAC,IAAI,EAAE,KAAK,EAAE,EAAE,CAAC,IAAI,wBAAS,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,QAAQ,EAAE,CAAC;iBAC7E,GAAG,CAAC,CAAE,oCAAO,CAAC,aAAa,EAAE,oCAAO,CAAC,qBAAqB,CAAE,EAAE,GAAG,EAAE,CAClE,CAAC,CAAE,IAAI,EAAE,GAAG,CAA+C,EAAE,EAAE;YAC/D,8EAA8E;YAC5E,IAAI,4CAAe,CACjB,IAAA,kDAAqB,EAAC,IAAI,CAAC,UAAU,EAAE,IAAA,4DAA+B,EAAC,GAAG,CAAC,UAAU,CAAC,CAAC,CACxF,CAAC;iBACL,IAAI,CAAC;gBACJ,IAAI,EAAE,CAAE,oCAAO,CAAC,aAAa,EAAE,oCAAO,CAAC,qBAAqB,CAAE;gBAC9D,EAAE,EAAE,CAAE,oCAAO,CAAC,aAAa,EAAE,oCAAO,CAAC,uBAAuB,CAAE;aAC/D,CAAC;iBACD,GAAG,CAAC,CAAE,oCAAO,CAAC,QAAQ,EAAE,oCAAO,CAAC,qBAAqB,CAAE,EAAE,GAAG,EAAE,CAC7D,CAAC,CAAE,IAAI,EAAE,GAAG,CAAkC,EAAE,EAAE;YAClD,0EAA0E;YACxE,IAAI,wCAAW,CACb,IAAA,kDAAqB,EACnB,IAAA,4DAA+B,EAAC,IAAI,CAAC,UAAU,CAAC,EAChD,IAAA,4DAA+B,EAAC,GAAG,CAAC,UAAU,CAAC,CAChD,CACF,CAAC;iBACL,IAAI,CAAC;gBACJ,IAAI,EAAE,CAAE,oCAAO,CAAC,QAAQ,EAAE,oCAAO,CAAC,qBAAqB,CAAE;gBACzD,EAAE,EAAE,CAAE,oCAAO,CAAC,QAAQ,EAAE,oCAAO,CAAC,uBAAuB,CAAE;aAC1D,CAAC;iBACD,GAAG,CAAC,CAAE,oCAAO,CAAC,QAAQ,EAAE,oCAAO,CAAC,qBAAqB,CAAE,EAAE,GAAG,EAAE,CAC7D,CAAC,CAAE,IAAI,EAAE,GAAG,CAAkC,EAAE,EAAE;YAClD,0EAA0E;YACxE,IAAI,wCAAW,CACb,IAAA,kDAAqB,EACnB,IAAA,4DAA+B,EAAC,IAAI,CAAC,UAAU,CAAC,EAChD,IAAA,4DAA+B,EAAC,GAAG,CAAC,UAAU,CAAC,CAChD,CACF,CAAC;iBACL,IAAI,CAAC;gBACJ,IAAI,EAAE,CAAE,oCAAO,CAAC,QAAQ,EAAE,oCAAO,CAAC,qBAAqB,CAAE;gBACzD,EAAE,EAAE,CAAE,oCAAO,CAAC,QAAQ,EAAE,oCAAO,CAAC,uBAAuB,CAAE;aAC1D,CAAC;iBACD,OAAO,EAAE;SACb,CAAC,CAAC;IACL,CAAC;CACF;AA9CD,oDA8CC","sourcesContent":["import { TermFunctionBase } from '@comunica/bus-function-factory';\nimport type {\n\n  DayTimeDurationLiteral,\n  DurationLiteral,\n} from '@comunica/utils-expression-evaluator';\nimport {\n  addDurationToDateTime,\n  DateLiteral,\n  DateTimeLiteral,\n  declare,\n  defaultedDateTimeRepresentation,\n  defaultedDurationRepresentation,\n  SparqlOperator,\n  TimeLiteral,\n  TypeURL,\n} from '@comunica/utils-expression-evaluator';\nimport { BigNumber } from 'bignumber.js';\n\nexport class TermFunctionAddition extends TermFunctionBase {\n  public constructor() {\n    super({\n      arity: 2,\n      operator: SparqlOperator.ADDITION,\n      overloads: declare(SparqlOperator.ADDITION)\n        .arithmetic(() => (left, right) => new BigNumber(left).plus(right).toNumber())\n        .set([ TypeURL.XSD_DATE_TIME, TypeURL.XSD_DAY_TIME_DURATION ], () =>\n          ([ date, dur ]: [ DateTimeLiteral, DayTimeDurationLiteral ]) =>\n          // https://www.w3.org/TR/xpath-functions/#func-add-dayTimeDuration-to-dateTime\n            new DateTimeLiteral(\n              addDurationToDateTime(date.typedValue, defaultedDurationRepresentation(dur.typedValue)),\n            ))\n        .copy({\n          from: [ TypeURL.XSD_DATE_TIME, TypeURL.XSD_DAY_TIME_DURATION ],\n          to: [ TypeURL.XSD_DATE_TIME, TypeURL.XSD_YEAR_MONTH_DURATION ],\n        })\n        .set([ TypeURL.XSD_DATE, TypeURL.XSD_DAY_TIME_DURATION ], () =>\n          ([ date, dur ]: [DateLiteral, DurationLiteral]) =>\n          // https://www.w3.org/TR/xpath-functions/#func-add-dayTimeDuration-to-date\n            new DateLiteral(\n              addDurationToDateTime(\n                defaultedDateTimeRepresentation(date.typedValue),\n                defaultedDurationRepresentation(dur.typedValue),\n              ),\n            ))\n        .copy({\n          from: [ TypeURL.XSD_DATE, TypeURL.XSD_DAY_TIME_DURATION ],\n          to: [ TypeURL.XSD_DATE, TypeURL.XSD_YEAR_MONTH_DURATION ],\n        })\n        .set([ TypeURL.XSD_TIME, TypeURL.XSD_DAY_TIME_DURATION ], () =>\n          ([ time, dur ]: [TimeLiteral, DurationLiteral]) =>\n          // https://www.w3.org/TR/xpath-functions/#func-add-dayTimeDuration-to-time\n            new TimeLiteral(\n              addDurationToDateTime(\n                defaultedDateTimeRepresentation(time.typedValue),\n                defaultedDurationRepresentation(dur.typedValue),\n              ),\n            ))\n        .copy({\n          from: [ TypeURL.XSD_TIME, TypeURL.XSD_DAY_TIME_DURATION ],\n          to: [ TypeURL.XSD_TIME, TypeURL.XSD_YEAR_MONTH_DURATION ],\n        })\n        .collect(),\n    });\n  }\n}\n"]}